#======================= Global Settings =======================

[global]
   # Recommended modern SMB baseline
   server min protocol = SMB2
   server smb encrypt = desired
   #ntlm auth = disabled

   # macOS interoperability
   vfs objects = catia fruit streams_xattr
   fruit:metadata = stream
   fruit:resource = xattr
   fruit:posix_rename = yes
   fruit:locking = none
   fruit:nfs_aces = no

   # Metadata / ACL plumbing
   ea support = yes
   store dos attributes = yes
   map acl inherit = yes

   workgroup = WORKGROUP
   server string = %h server (Samba, Ubuntu)

   log file = /var/log/samba/log.%m
   max log size = 1000
   logging = file
   panic action = /usr/share/samba/panic-action %d

   server role = standalone server
   obey pam restrictions = yes
   unix password sync = yes
   passwd program = /usr/bin/passwd %u
   passwd chat = *Enter\snew\s*\spassword:* %n\n *Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* .
   pam password change = yes
   map to guest = bad user
   usershare allow guests = yes

#======================= Share Definitions =======================

[homes]
   comment = Home Directories
   browseable = no
   veto oplock files = *
   map archive = no
   map system = no
   map hidden = no
   store dos attributes = yes
   unix extensions = yes

[printers]
   comment = All Printers
   browseable = no
   path = /var/tmp
   printable = yes
   guest ok = no
   read only = yes
   create mask = 0700

[print$]
   comment = Printer Drivers
   path = /var/lib/samba/printers
   browseable = yes
   read only = yes
   guest ok = no

[media]
   path = /srv/media
   browseable = yes
   read only = no
   valid users = @media
   force group = media
   create mask = 0664
   directory mask = 2775

[timemachine]
   path = /srv/timemachine
   browseable = yes
   read only = no
   guest ok = no
   valid users = @timemachine
   force group = timemachine
   fruit:time machine = yes
   fruit:time machine max size = 2000G
   veto files = /._*/.DS_Store/
   delete veto files = yes
